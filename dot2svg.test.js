import * as t from "https://deno.land/std/testing/asserts.ts";
import { dot2svg } from "./dot2svg.js";

Deno.test("simple", () => {
  t.assertEquals(dot2svg([[1]], 10), `<rect x="0" y="0" width="10" height="10"/>`)
  t.assertEquals(dot2svg([[1, 0], [0, 1]], 10), `<rect x="0" y="0" width="10" height="10"/>
<rect x="10" y="10" width="10" height="10"/>`)
});
Deno.test("rect", () => {
  t.assertEquals(dot2svg([[1, 1], [0, 0]], 10), `<rect x="0" y="0" width="20" height="10"/>`)
  t.assertEquals(dot2svg([[1, 0], [1, 0]], 10), `<rect x="0" y="0" width="10" height="20"/>`)
  t.assertEquals(dot2svg([[1, 1], [1, 1]], 10), `<rect x="0" y="0" width="20" height="20"/>`)
});
Deno.test("polygon", () => {
  t.assertEquals(dot2svg([[1, 1], [1, 0]], 10), `<polygon points="0,0 20,0 20,10 10,10 10,20 0,20 0,0"/>`)
  t.assertEquals(dot2svg([[1, 1, 1], [1, 0, 1]], 10), `<polygon points="0,0 30,0 30,20 20,20 20,10 10,10 10,20 0,20 0,0"/>`)
  t.assertEquals(dot2svg([[1, 1, 1], [1, 0, 1], [0, 1, 0]], 10), `<polygon points="0,0 30,0 30,20 20,20 20,10 10,10 10,20 0,20 0,0"/>
<rect x="10" y="20" width="10" height="10"/>`)
});
Deno.test("polygon hole", () => {
  const dots = `111\n101\n111`;
  t.assertEquals(dot2svg(dots, 10), `<polygon points="0,0 30,0 30,30 0,30 0,0 10,10 10,20 20,20 20,10 10,10"/>`)
  t.assertEquals(dot2svg(`
111111
100001
101101
100001
111111
`, 10), `<polygon points="0,0 60,0 60,50 0,50 0,0 20,20 40,20 40,30 20,30 20,20 10,10 10,40 50,40 50,10 10,10"/>`)
});

Deno.test("polygon hole2", () => {
  
  t.assertEquals(dot2svg(`
111111
100001
111101
100101
111111
`, 10), `<polygon points="0,0 60,0 60,50 0,50 0,0 10,10 10,20 40,20 40,40 50,40 50,10 10,10 10,30 10,40 30,40 30,30 10,30"/>`)
});



Deno.test("polygon hole3", () => {
  t.assertEquals(dot2svg(`
1111111
1000001
1011101
1010101
1011101
1000001
1111111
  `, 10), `<polygon points="0,0 70,0 70,70 0,70 0,0 20,20 50,20 50,50 20,50 20,20 30,30 30,40 40,40 40,30 30,30 10,10 10,60 60,60 60,10 10,10"/>`)
});

Deno.test("polygon hole3_1", () => {
  t.assertEquals(dot2svg(`
0000000
0000000
0011100
0010100
0011100
0000000
0000000
  `, 10), `<polygon points="20,20 50,20 50,50 20,50 20,20 30,30 30,40 40,40 40,30 30,30"/>`)
});

Deno.test("polygon hole g", () => {
  t.assertEquals(dot2svg(`
0111100
0101000
0111000
0001000
0111000
0000000
0000000
  `, 10), `<polygon points="10,0 50,0 50,10 40,10 40,50 10,50 10,40 30,40 30,30 10,30 10,0 20,10 20,20 30,20 30,10 20,10"/>`)
});
Deno.test("polygon hole ichigo", () => {
  t.assertEquals(dot2svg(`
00000100
00111110
00101111
01010110
01101010
11010110
10101100
11110000
  `, 10), `<polygon points="50,0 60,0 60,10 70,10 70,20 80,20 80,30 70,30 70,60 60,60 60,70 40,70 40,60 50,60 50,50 60,50 60,40 50,40 50,30 40,30 40,20 30,20 30,30 20,30 20,10 50,10 50,0"/>
<polygon points="10,30 20,30 20,40 30,40 30,50 20,50 20,60 10,60 10,70 20,70 20,60 30,60 30,70 40,70 40,80 0,80 0,50 10,50 10,30"/>
<rect x="30" y="30" width="10" height="10"/>
<rect x="40" y="40" width="10" height="10"/>
<rect x="30" y="50" width="10" height="10"/>`)
});
Deno.test("round", () => {
  t.assertEquals(dot2svg([[1, 1, 1], [1, 0, 1], [0, 1, 0]], 10, 1), `<path d="M1,0L29,0Q30,0 30,1L30,19Q30,20 29,20L21,20Q20,20 20,19L20,11Q20,10 19,10L11,10Q10,10 10,11L10,19Q10,20 9,20L1,20Q0,20 0,19L0,1Q0,0 1,0M11,20L19,20Q20,20 20,21L20,29Q20,30 19,30L11,30Q10,30 10,29L10,21Q10,20 11,20"/>`)
});
Deno.test("round2", () => {
  t.assertEquals(dot2svg("111\n101\n111", 10, 1), `<path d="M1,0L29,0Q30,0 30,1L30,29Q30,30 29,30L1,30Q0,30 0,29L0,1Q0,0 1,0M10,11L10,19Q10,20 11,20L19,20Q20,20 20,19L20,11Q20,10 19,10L11,10Q10,10 10,11"/>`)
});
Deno.test("round3 hole3", () => {
  t.assertEquals(dot2svg(`
1111111
1000001
1011101
1010101
1011101
1000001
1111111
  `, 10, 1), `<path d="M1,0L69,0Q70,0 70,1L70,69Q70,70 69,70L1,70Q0,70 0,69L0,1Q0,0 1,0M21,20L49,20Q50,20 50,21L50,49Q50,50 49,50L21,50Q20,50 20,49L20,21Q20,20 21,20M30,31L30,39Q30,40 31,40L39,40Q40,40 40,39L40,31Q40,30 39,30L31,30Q30,30 30,31M10,11L10,59Q10,60 11,60L59,60Q60,60 60,59L60,11Q60,10 59,10L11,10Q10,10 10,11"/>`)
});
